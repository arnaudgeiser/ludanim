plugins {
  id 'net.researchgate.release' version '2.4.0'
  id "com.moowork.node" version "1.0.1"
  id "com.moowork.gulp" version "1.0.1"
  id 'com.craigburke.client-dependencies' version '1.3.1'
}

apply plugin: 'distribution'
apply plugin: 'maven'

distributions {
	main {
		baseName = 'ludanim'
		contents {
			from { 'dist' }
		}
	}
}

uploadArchives {
	repositories {
		mavenDeployer {
			repository(url: "http://archiva.ludine.ch/repository/internal") {
				authentication(userName: archivaUser, password: archivaPassword)
			};
			snapshotRepository(url: "http://archiva.ludine.ch/repository/snapshots") {
				authentication(userName: archivaUser, password: archivaPassword)
			};
			pom.artifactId = 'ludanim'
			pom.groupId = 'ch.waterbead'
		}
	}
}

node {
	version="6.9.2"
	npmVersion="3.10.9"
	download=true
}

task bower(type:Exec) {
	commandLine 'bower','install'
}

gulp_build.dependsOn 'npmInstall'
gulp_build.dependsOn 'installGulp'

afterReleaseBuild.dependsOn uploadArchives
uploadArchives.dependsOn build
build.dependsOn gulp_default
build.dependsOn gulp_build
gulp_build.dependsOn bower
